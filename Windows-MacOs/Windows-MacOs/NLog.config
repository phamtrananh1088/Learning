<?xml version="1.0" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <targets>
    <target name="errorlog" xsi:type="File" fileName="${basedir}/logs/Torihiki_Error_${shortdate}.log"
            maxArchiveFiles="7"
            layout="${longdate} ${event-properties:item=USER_CD} ${event-properties:item=URL} ${event-properties:item=PAGE} : ${message} ${onexception: ${newline} ${exception:format=tostring} " />

    <target name="tracelog" xsi:type="File" fileName="${basedir}/logs/Torihiki_Trace_${shortdate}.log"
            layout="${longdate} ${event-properties:item=USER_CD} ${event-properties:item=URL} ${event-properties:item=PAGE} : ${message} ${onexception:${exception:format=tostring} ${newline} ${stacktrace} ${newline}" />

    <target name="actionlog" xsi:type="File" fileName="${basedir}/logs/Torihiki_Action_${shortdate}.log"
            maxArchiveFiles="10" archiveAboveSize="10485760"
            layout="${longdate} ${event-properties:item=USER_CD} ${event-properties:item=IPADDR} ${event-properties:item=URL} ${event-properties:item=PAGE} ${event-properties:item=ACTION} : ${message} ${onexception:${exception:format=tostring} ${newline} ${stacktrace} ${newline}" />

    <target name="debuglog" xsi:type="File" fileName="${basedir}/logs/Torihiki_Debug_${shortdate}.log"
            maxArchiveFiles="7" 
            layout="${longdate} ${event-properties:item=USER_CD} ${event-properties:item=URL} ${event-properties:item=PAGE} : ${message} ${onexception:${exception:format=tostring} ${newline} ${stacktrace} ${newline}" />
  
    <target name="sqllog" xsi:type="File" fileName="${basedir}/logs/Torihiki_Sql_${shortdate}.log"
            maxArchiveFiles="7" archiveAboveSize="1048576"
            layout="${longdate} ${event-properties:item=USER_CD} ${event-properties:item=IPADDR} ${event-properties:item=URL} ${event-properties:item=PAGE} ${event-properties:item=ACTION} ${newline}${event-properties:item=SqlStatment}${newline}${newline}${event-properties:item=SQL}${newline}" />
  
      <target name="apilog" xsi:type="File" fileName="${basedir}/logs/Torihiki_Api_${shortdate}.log"
            maxArchiveFiles="7" archiveAboveSize="1048576"
            layout="${longdate} ${event-properties:item=USER_CD} ${event-properties:item=IPADDR} ${event-properties:item=URL} ${event-properties:item=PAGE} ${newline}参照URL: ${event-properties:item=ReferrerUrl} ${newline}請求URL: ${event-properties:item=RequestUrl} ${newline}リクエストデータ:${newline}${event-properties:item=ReqJsonData} ${newline}レスポンス結果:${newline}${event-properties:item=ResJsonData}${newline}" />

  </targets>
  <rules>
    <logger name="*" level="Info" writeTo="sqllog">
        <filters>
            <when condition="equals('${message}','SQL')" action="Log" />
            <when condition="not equals('${message}','SQL')" action="Ignore" />
        </filters>
    </logger>
    <logger name="*" level="Info" writeTo="apilog">
        <filters>
            <when condition="equals('${message}','API')" action="Log" />
            <when condition="not equals('${message}','API')" action="Ignore" />
        </filters>
    </logger>
    <logger name="*" levels="Warn,Info" writeTo="actionlog">  
        <filters>
            <when condition="equals('${message}','SQL')" action="Ignore" />
            <when condition="equals('${message}','API')" action="Ignore" />
        </filters>
    </logger>
    <!--<logger name="*" levels="Error,Trace,Fatal" writeTo="tracelog" />-->
    <logger name="*" level="Debug" writeTo="debuglog" />
    <logger name="*" level="Error" writeTo="errorlog" />
  </rules>
</nlog>